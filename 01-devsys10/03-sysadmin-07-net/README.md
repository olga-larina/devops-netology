# Olga Ivanova, devops-10. Домашнее задание к занятию "3.7. Компьютерные сети, лекция 2"

1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?

Ответ:  
```bash
[olga@fedora ~]$ ip -c -br link
lo               UNKNOWN        00:00:00:00:00:00 <LOOPBACK,UP,LOWER_UP>
enp2s0           DOWN           04:d4:c4:eb:a4:df <NO-CARRIER,BROADCAST,MULTICAST,UP>
wlp4s0           UP             c0:e4:34:27:70:c7 <BROADCAST,MULTICAST,UP,LOWER_UP>
virbr0           DOWN           52:54:00:1e:d0:2e <NO-CARRIER,BROADCAST,MULTICAST,UP>
vpn0             UP             <POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP>
docker0          DOWN           02:42:a7:9e:ee:c0 <NO-CARRIER,BROADCAST,MULTICAST,UP>
```
В Linux для этого используется команда `ip`. 
В Windows - `ipconfig`, `netsh interface show interface`, `netsh interface ip show interfaces`.

2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?

Ответ:  
Это протокол LLDP (Link Layer Discovery Protocol). В Linux для этого есть пакет `lldpd` и команда `lldpctl`:
```bash
vagrant@vagrant:~$ sudo apt install lldpd
vagrant@vagrant:~$ sudo systemctl enable lldpd && sudo systemctl start lldpd
vagrant@vagrant:~$ lldpctl
```

3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? 
   Приведите пример конфига.
   
Ответ:  
Для этого используется VLAN – виртуальное разделение коммутатора. В Linux для этого есть пакет `vlan`, команда `vconfig` и возможность редактирования файла `/etc/network/interfaces`.  
Пример конфига (`/etc/network/interfaces`):  
```bash
auto vlan333
iface vlan333 inet static
        address 192.168.1.1
        netmask 255.255.255.0
        vlan_raw_device eth0
```

4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.

Ответ:  
Типы агрегирования каналов в Cisco:  
- статическое (без использования протоколов)  
- PAgP (Port Aggregation Protocol) проприетарный протокол Cisco  
- LACP (Link Aggregation Control Protocol) стандартный протокол  
  
LACP и PAgP решают одни и те же задачи (с небольшими отличиями по возможностям).

Балансировка нагрузки:  
- по MAC-адресу отправителя или MAC-адресу получателя или учитывая оба адреса  
- по IP-адресу отправителя или IP-адресу получателя или учитывая оба адреса  
- по номеру порта отправителя или номеру порта получателя или учитывая оба порта  

Для бондинга в Linux используется пакет `ifenslave`. 
Пример конфига (`/etc/network/interfaces`):
```bash
auto bond0

iface bond0 inet static
address 10.31.1.5
netmask 255.255.255.0
network 10.31.1.0
gateway 10.31.1.254
slaves eth0 eth1
bond-mode active-backup
bond-miimon 100
bond-downdelay 200
bond-updelay 200
```

5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. 
   Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.
   
Ответ:  
/29 означает, что в маске задано 29 битов из 32 (255.255.255.248 = 11111111.11111111.11111111.11111000). Значит, IP-адресов будет 2^(32 - 29)=8.  
Маска /24 - это 255.255.255.000 = 11111111.11111111.11111111.00000000. Таким образом, из сети с маской /24 можно получить 2^5=32 подсети /29.  
Примеры:  
```bash
vagrant@vagrant:~$ ipcalc 10.10.10.0 255.255.255.000 255.255.255.248
Address:   10.10.10.0           00001010.00001010.00001010. 00000000
Netmask:   255.255.255.0 = 24   11111111.11111111.11111111. 00000000
Wildcard:  0.0.0.255            00000000.00000000.00000000. 11111111
=>
Network:   10.10.10.0/24        00001010.00001010.00001010. 00000000
HostMin:   10.10.10.1           00001010.00001010.00001010. 00000001
HostMax:   10.10.10.254         00001010.00001010.00001010. 11111110
Broadcast: 10.10.10.255         00001010.00001010.00001010. 11111111
Hosts/Net: 254                   Class A, Private Internet

Subnets after transition from /24 to /29

Netmask:   255.255.255.248 = 29 11111111.11111111.11111111.11111 000
Wildcard:  0.0.0.7              00000000.00000000.00000000.00000 111

 1.
Network:   10.10.10.0/29        00001010.00001010.00001010.00000 000
HostMin:   10.10.10.1           00001010.00001010.00001010.00000 001
HostMax:   10.10.10.6           00001010.00001010.00001010.00000 110
Broadcast: 10.10.10.7           00001010.00001010.00001010.00000 111
Hosts/Net: 6                     Class A, Private Internet

 2.
Network:   10.10.10.8/29        00001010.00001010.00001010.00001 000
HostMin:   10.10.10.9           00001010.00001010.00001010.00001 001
HostMax:   10.10.10.14          00001010.00001010.00001010.00001 110
Broadcast: 10.10.10.15          00001010.00001010.00001010.00001 111
Hosts/Net: 6                     Class A, Private Internet

 3.
Network:   10.10.10.16/29       00001010.00001010.00001010.00010 000
HostMin:   10.10.10.17          00001010.00001010.00001010.00010 001
HostMax:   10.10.10.22          00001010.00001010.00001010.00010 110
Broadcast: 10.10.10.23          00001010.00001010.00001010.00010 111
Hosts/Net: 6                     Class A, Private Internet

........

 32.
Network:   10.10.10.248/29      00001010.00001010.00001010.11111 000
HostMin:   10.10.10.249         00001010.00001010.00001010.11111 001
HostMax:   10.10.10.254         00001010.00001010.00001010.11111 110
Broadcast: 10.10.10.255         00001010.00001010.00001010.11111 111
Hosts/Net: 6                     Class A, Private Internet


Subnets:   32
Hosts:     192
```

6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. 
   Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.

Ответ:  
Частные IP-адреса допустимо взять из 100.64.0.0/10. Если выберем маску 255.255.255.192 (т.е. 11111111.11111111.11111111.11000000), 
получим, что внутри подсети будет 2^6 = 64 хоста.  
```bash
vagrant@vagrant:~$ ipcalc -b --split 50 100.64.0.0/10
Address:   100.64.0.0           
Netmask:   255.192.0.0 = 10     
Wildcard:  0.63.255.255         
=>
Network:   100.64.0.0/10        
HostMin:   100.64.0.1           
HostMax:   100.127.255.254      
Broadcast: 100.127.255.255      
Hosts/Net: 4194302               Class A

1. Requested size: 50 hosts
Netmask:   255.255.255.192 = 26 
Network:   100.64.0.0/26        
HostMin:   100.64.0.1           
HostMax:   100.64.0.62          
Broadcast: 100.64.0.63          
Hosts/Net: 62                    Class A

Needed size:  64 addresses.
Used network: 100.64.0.0/26
Unused:
100.64.0.64/26
100.64.0.128/25
100.64.1.0/24
100.64.2.0/23
100.64.4.0/22
100.64.8.0/21
100.64.16.0/20
100.64.32.0/19
100.64.64.0/18
100.64.128.0/17
100.65.0.0/16
100.66.0.0/15
100.68.0.0/14
100.72.0.0/13
100.80.0.0/12
100.96.0.0/11
```

7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?

Ответ:  
Проверка ARP-таблицы Windows:  
```bash
arp -a
```
Проверка ARP-таблицы Linux:
```bash
vagrant@vagrant:~$ arp -a
? (10.0.2.2) at 52:54:00:12:35:02 [ether] on eth0
? (10.0.2.3) at 52:54:00:12:35:03 [ether] on eth0
vagrant@vagrant:~$ ip neigh
10.0.2.2 dev eth0 lladdr 52:54:00:12:35:02 DELAY
10.0.2.3 dev eth0 lladdr 52:54:00:12:35:03 REACHABLE
```
Очистка ARP кеша Windows:  
```bash
netsh interface ip delete arpcache
```
Очистка ARP кеша Linux:
```bash
vagrant@vagrant:~$ sudo ip neigh flush all
```  
Удаление IP из ARP-таблицы Windows:
```bash
arp -d 192.168.100.25
```
Удаление IP из ARP-таблицы Linux:
```bash
vagrant@vagrant:~$ sudo arp -d 10.0.2.2
vagrant@vagrant:~$ sudo ip neigh delete 10.0.2.2 dev eth0
```